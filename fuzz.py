from boofuzz import *
host = "192.168.1.6"
port = 21 
start_cmd = "net start \"Solar FTP Server\""
stop_cmd = "net stop \"Solar FTP Server\""
proc_name = "sfsservice.exe"
def main():
    session = Session(
        target=Target(
            connection=SocketConnection(host, port, proto='tcp'),
            procmon=pedrpc.Client(host, 26002),
            procmon_options={
                            "proc_name": proc_name,
                            "stop_commands": [start_cmd],
                            "start_commands": [start_cmd]
                            }
),
        web_port =8080)    
    
    s_initialize("user")
    s_static("USER")
    s_delim(" ")
    s_static("test")
    s_static("\r\n")
           
    s_initialize("pass")
    s_static("PASS")
    s_delim(" ")
    s_string("test")
    s_static("\r\n")
    
    s_initialize("pasv")
    s_static("PASV")
    s_delim(" ")
    s_string("Fuzz")
    s_static("\r\n")
    session.connect(s_get("user"))
    session.connect(s_get("user"), s_get("pass"))
    session.connect(s_get("pass"), s_get("pasv"))
       
    session.fuzz()
if __name__ == "__main__":
    main()
